# btl_analysis

Была поставлена **задача** сбора базы российских BTL и маркетинговых агентств полного цикла, а также коммуникационных групп, с годовой выручкой ≥ 200 млн ₽ за последний доступный год.  

## Подход
Был выбран следуюший подход:  
1. Сбор данных о компаниях (название) через рейтинги из сайта (парсинг) [http://www.all20.ru/btl/](http://www.all20.ru/btl/).  
2. После того как был собран список компаний, необходимо было узнать их ИНН. Для этого был использован сервис [https://b2b.house/](https://b2b.house/) (парсинг), где заренее были выствавлены фильтры по ОКВЕД: 70, 73, которые относятся к BTL и маркетинговым агентствам.  
3. Как только получили ИНН компаний открывался доступ к дополнительной информации о них через сайт [https://checko.ru/](https://checko.ru/) (парсинг).  

После того как была собрана информация о компаниях, создаем csv файл, после чего обрабываем его. Получанные результаты после парсинга сохраняем в файлах в папке `data/raw`, обработаный csv файл будет находится в папке `data/processed/companies.csv`.

## Запуск кода
Для начала нужно загрузить необходмые библиотеки, используя `pip install -r requirements.txt`. Затем запустить скрипт `main.py` в корневой директории проекта, используя команду `python main.py` или `python3 main.py`. Также стоит следить за выводами программы, так как сайт может запросить пройти капчу. В этом случае программа будет ожидать прохождения этой капчи.

## Что получилось/не получилось реализовать
Был реализован парсинг данных с сайта с рейтингом BTL компаний, с последующим парсингом дополнительных данных об этих компаниях.  
Конечно, в иделе было бы неплохо подготовить csv файл, в котором находились нужные для проверки компании и их ИНН, самостоятельно (руками). Но из-за ограниченного количество времени, решил использовать парсинг, для нахождения ИНН, используя название компании и их предполагаемый телефон, который был указан на сайте рейтинга. Из-за чего количество компаний в файле `companies.csv`, которые необходимо найти по заданию, значительно меньше, чем было бы в идеале.  
Так как в разных сайтах компании названы по разному, некоторые из них, которые были в рейтинге, не были найдены в `https://b2b.house/`. Данную проблему также не смог решить поиск по номеру телефона, потому что он не уникален и может быть использован несколькими компаниями.  
Также можно дополнить базу, парсингом и других рубрик, например в [http://www.all20.ru/btl/](http://www.all20.ru/btl/) есть рейтинги компании, которые учавствуют в них.  
Из вышеперечисленного могу сказать, что лучше надо было подготовить csv файл с компаниями из рейтинга и их ИНН самостоятельно, потом уже используя сайт [https://checko.ru/](https://checko.ru/) распарсить необходимые данные (выручка, количество сортрудников и т.д.) и можно было не мучаться с блокировками от сайта.

## Нововведения
- Добавил парсинг рейтинга новых рубрик из того же сайта [http://www.all20.ru/](http://www.all20.ru/). Теперь рассматривается не только "BTL агентства", но и "Мерчандайзинг" и "Сувенирная продукция", что привело к увеличению количества компаний в `companies.csv`.
